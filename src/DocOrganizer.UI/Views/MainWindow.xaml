<Window x:Class="DocOrganizer.UI.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="DocOrganizer 2.2" 
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#F0F0F0"
        AllowDrop="True"
        Drop="Window_Drop"
        DragEnter="Window_DragEnter"
        DragOver="Window_DragOver"
        DragLeave="Window_DragLeave">
    
    <!-- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ -->
    <Window.InputBindings>
        <KeyBinding Key="O" Modifiers="Ctrl" Command="{Binding OpenCommand}"/>
        <KeyBinding Key="S" Modifiers="Ctrl" Command="{Binding SaveCommand}"/>
        <KeyBinding Key="A" Modifiers="Ctrl" Command="{Binding SelectAllCommand}"/>
        <KeyBinding Key="Z" Modifiers="Ctrl" Command="{Binding UndoCommand}"/>
        <KeyBinding Key="Y" Modifiers="Ctrl" Command="{Binding RedoCommand}"/>
        <KeyBinding Key="Delete" Command="{Binding DeleteCommand}"/>
        <KeyBinding Key="F1" Command="{Binding ShowHelpCommand}"/>
        <KeyBinding Key="OemPlus" Modifiers="Ctrl" Command="{Binding ZoomInCommand}"/>
        <KeyBinding Key="OemMinus" Modifiers="Ctrl" Command="{Binding ZoomOutCommand}"/>
    </Window.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ -->
        <Menu Grid.Row="0" Background="White">
            <MenuItem Header="ãƒ•ã‚¡ã‚¤ãƒ«(_F)">
                <MenuItem Header="PDFãƒ»ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã(_O)..." Command="{Binding OpenCommand}" InputGestureText="Ctrl+O">
                    <MenuItem.Icon>
                        <TextBlock Text="ðŸ“‚" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="ä¿å­˜(_S)" Command="{Binding SaveCommand}" InputGestureText="Ctrl+S">
                    <MenuItem.Icon>
                        <TextBlock Text="ðŸ’¾" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜(_A)..." Command="{Binding SaveAsCommand}"/>
                <Separator/>
                <MenuItem Header="é–‰ã˜ã‚‹(_C)" Command="{Binding CloseCommand}"/>
                <Separator/>
                <MenuItem Header="çµ‚äº†(_X)" Command="{Binding ExitCommand}" InputGestureText="Alt+F4"/>
            </MenuItem>
            
            <MenuItem Header="ç·¨é›†(_E)">
                <MenuItem Header="å…ƒã«æˆ»ã™(_U)" Command="{Binding UndoCommand}" InputGestureText="Ctrl+Z"/>
                <MenuItem Header="ã‚„ã‚Šç›´ã—(_R)" Command="{Binding RedoCommand}" InputGestureText="Ctrl+Y"/>
                <Separator/>
                <MenuItem Header="ã™ã¹ã¦é¸æŠž(_A)" Command="{Binding SelectAllCommand}" InputGestureText="Ctrl+A"/>
                <MenuItem Header="é¸æŠžè§£é™¤(_D)" Command="{Binding DeselectAllCommand}"/>
            </MenuItem>
            
            <MenuItem Header="ãƒšãƒ¼ã‚¸(_P)">
                <MenuItem Header="å·¦å›žè»¢(_L)" Command="{Binding RotateLeftCommand}">
                    <MenuItem.Icon>
                        <TextBlock Text="â†º" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="å³å›žè»¢(_R)" Command="{Binding RotateRightCommand}">
                    <MenuItem.Icon>
                        <TextBlock Text="â†»" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="å‰Šé™¤(_D)" Command="{Binding DeleteCommand}" InputGestureText="Delete">
                    <MenuItem.Icon>
                        <TextBlock Text="ðŸ—‘" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            
            <MenuItem Header="æ–‡æ›¸(_D)">
                <MenuItem Header="çµåˆ(_M)..." Command="{Binding MergeCommand}">
                    <MenuItem.Icon>
                        <TextBlock Text="ðŸ“‹" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="åˆ†å‰²(_S)..." Command="{Binding SplitCommand}">
                    <MenuItem.Icon>
                        <TextBlock Text="âœ‚" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š(_E)..." Command="{Binding SecurityCommand}"/>
            </MenuItem>
            
            <MenuItem Header="è¡¨ç¤º(_V)">
                <MenuItem Header="æ‹¡å¤§(_I)" Command="{Binding ZoomInCommand}" InputGestureText="Ctrl++"/>
                <MenuItem Header="ç¸®å°(_O)" Command="{Binding ZoomOutCommand}" InputGestureText="Ctrl+-"/>
                <MenuItem Header="å…¨ä½“è¡¨ç¤º(_F)" Command="{Binding FitToWindowCommand}"/>
                <Separator/>
                <MenuItem Header="ã‚µãƒ ãƒã‚¤ãƒ«ã‚µã‚¤ã‚º(_T)">
                    <MenuItem Header="å°" Command="{Binding ThumbnailSmallCommand}" IsCheckable="True"/>
                    <MenuItem Header="ä¸­" Command="{Binding ThumbnailMediumCommand}" IsCheckable="True" IsChecked="True"/>
                    <MenuItem Header="å¤§" Command="{Binding ThumbnailLargeCommand}" IsCheckable="True"/>
                </MenuItem>
            </MenuItem>
            
            <MenuItem Header="ãƒ˜ãƒ«ãƒ—(_H)">
                <MenuItem Header="ãƒ˜ãƒ«ãƒ—ã®è¡¨ç¤º(_H)" Command="{Binding ShowHelpCommand}" InputGestureText="F1"/>
                <Separator/>
                <MenuItem Header="ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®ç¢ºèª(_U)..." Command="{Binding CheckForUpdatesCommand}">
                    <MenuItem.Icon>
                        <TextBlock Text="ðŸ”„" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±(_A)..." Command="{Binding AboutCommand}"/>
            </MenuItem>
        </Menu>

        <!-- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
        <ToolBarTray Grid.Row="1" Background="White">
            <ToolBar x:Name="MainToolBar" Background="Transparent">
                <!-- ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ -->
                <Button Command="{Binding OpenCommand}" ToolTip="PDFãƒ»ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã (Ctrl+O)" Padding="4" x:Name="OpenButton">
                    <TextBlock Text="ðŸ“‚" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button Command="{Binding SaveCommand}" ToolTip="ä¿å­˜ (Ctrl+S)" Padding="4">
                    <TextBlock Text="ðŸ’¾" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <!-- ãƒ†ã‚¹ãƒˆç”¨Clickã‚¤ãƒ™ãƒ³ãƒˆãƒœã‚¿ãƒ³ -->
                <Button Click="TestButton_Click" ToolTip="ã‚¯ãƒªãƒƒã‚¯ãƒ†ã‚¹ãƒˆ" Padding="4" Background="Yellow">
                    <TextBlock Text="TEST" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Separator/>
                
                <!-- ãƒšãƒ¼ã‚¸æ“ä½œ -->
                <Button Command="{Binding RotateLeftCommand}" ToolTip="å·¦å›žè»¢" Padding="4"
                        IsEnabled="{Binding HasSelectedPages}">
                    <TextBlock Text="â†º" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button Command="{Binding RotateRightCommand}" ToolTip="å³å›žè»¢" Padding="4"
                        IsEnabled="{Binding HasSelectedPages}">
                    <TextBlock Text="â†»" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button Command="{Binding DeleteCommand}" ToolTip="å‰Šé™¤ (Delete)" Padding="4"
                        IsEnabled="{Binding HasSelectedPages}">
                    <TextBlock Text="ðŸ—‘" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Separator/>
                
                <!-- PDFæ“ä½œ -->
                <Button Command="{Binding MergeCommand}" ToolTip="çµåˆ" Padding="4"
                        IsEnabled="{Binding CanMerge}">
                    <TextBlock Text="ðŸ“‹" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button Command="{Binding SplitCommand}" ToolTip="åˆ†å‰²" Padding="4"
                        IsEnabled="{Binding HasDocument}">
                    <TextBlock Text="âœ‚" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Separator/>
                
                <!-- è¡¨ç¤º -->
                <Button Command="{Binding ZoomInCommand}" ToolTip="æ‹¡å¤§" Padding="4">
                    <TextBlock Text="ðŸ”+" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button Command="{Binding ZoomOutCommand}" ToolTip="ç¸®å°" Padding="4">
                    <TextBlock Text="ðŸ”-" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <ComboBox Width="80" SelectedItem="{Binding ZoomLevel}" Margin="4,0">
                    <ComboBoxItem>50%</ComboBoxItem>
                    <ComboBoxItem>75%</ComboBoxItem>
                    <ComboBoxItem IsSelected="True">100%</ComboBoxItem>
                    <ComboBoxItem>125%</ComboBoxItem>
                    <ComboBoxItem>150%</ComboBoxItem>
                    <ComboBoxItem>200%</ComboBoxItem>
                </ComboBox>
            </ToolBar>
        </ToolBarTray>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220" MinWidth="150"/>
                <ColumnDefinition Width="3"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- å·¦å´ï¼šãƒšãƒ¼ã‚¸ã‚µãƒ ãƒã‚¤ãƒ« -->
            <Border Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="0,0,1,0" Background="White">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- ã‚µãƒ ãƒã‚¤ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ -->
                    <Border Grid.Row="0" Background="#E0E0E0" BorderBrush="#CCCCCC" BorderThickness="0,0,0,1">
                        <Grid Height="24">
                            <TextBlock Text="ãƒšãƒ¼ã‚¸" VerticalAlignment="Center" Margin="8,0" FontWeight="Bold"/>
                            <TextBlock Text="{Binding PageCountText}" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="8,0"/>
                        </Grid>
                    </Border>

                    <!-- ã‚µãƒ ãƒã‚¤ãƒ«ãƒªã‚¹ãƒˆ -->
                    <ListBox Grid.Row="1" 
                             x:Name="PageListBox"
                             ItemsSource="{Binding Pages}"
                             Background="White"
                             BorderThickness="0"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             SelectionMode="Extended"
                             AllowDrop="True"
                             Drop="ThumbnailList_Drop"
                             PreviewMouseLeftButtonDown="ThumbnailList_PreviewMouseLeftButtonDown"
                             PreviewMouseMove="ThumbnailList_PreviewMouseMove"
                             SelectionChanged="PageListBox_SelectionChanged"
                             IsSynchronizedWithCurrentItem="True">
                        
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Padding" Value="4"/>
                                <Setter Property="Margin" Value="4,2"/>
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#3399FF"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Background="White">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="120"/>
                                        </Grid.RowDefinitions>

                                        <!-- ãƒšãƒ¼ã‚¸ç•ªå· -->
                                        <Border Grid.Row="0" Background="#F0F0F0" BorderBrush="#CCCCCC" BorderThickness="0,0,0,1">
                                            <TextBlock Text="{Binding PageNumber, StringFormat='{}{0}'}" 
                                                       HorizontalAlignment="Center" 
                                                       Margin="4,2"
                                                       FontSize="11"/>
                                        </Border>

                                        <!-- ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒ -->
                                        <Border Grid.Row="1" Background="White" Margin="4">
                                            <Image Source="{Binding ThumbnailImage}" 
                                                   Stretch="Uniform"
                                                   RenderOptions.BitmapScalingMode="HighQuality"/>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>

            <!-- ã‚¹ãƒ—ãƒªãƒƒã‚¿ãƒ¼ -->
            <GridSplitter Grid.Column="1" 
                          HorizontalAlignment="Stretch" 
                          Background="#CCCCCC"
                          ShowsPreview="False"/>

            <!-- å³å´ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
            <Border Grid.Column="2" Background="#808080"
                    AllowDrop="True"
                    Drop="Window_Drop"
                    DragEnter="Window_DragEnter"
                    DragOver="Window_DragOver"
                    DragLeave="Window_DragLeave">
                <Grid>
                    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º -->
                    <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                                  VerticalScrollBarVisibility="Auto"
                                  Background="#808080"
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch">
                        <Border Background="White" 
                                Margin="20"
                                BorderBrush="#666666"
                                BorderThickness="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                            <Image Source="{Binding CurrentPageImage}" 
                                   Stretch="Uniform"
                                   MaxWidth="{Binding PreviewWidth}"
                                   MaxHeight="{Binding PreviewHeight}"
                                   RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Border>
                    </ScrollViewer>

                    <!-- ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
                    <Border x:Name="DropOverlay"
                            Background="#80000000" 
                            Visibility="Collapsed"
                            AllowDrop="True"
                            Drop="PreviewArea_Drop"
                            DragEnter="PreviewArea_DragEnter"
                            DragOver="PreviewArea_DragEnter"
                            DragLeave="PreviewArea_DragLeave">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock Text="ã“ã“ã«PDFã¾ãŸã¯ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—" 
                                       Foreground="White" 
                                       FontSize="20" 
                                       FontWeight="Bold"/>
                            <TextBlock Text="(PDF, HEIC, JPG, PNG, JPEGå¯¾å¿œ)" 
                                       Foreground="#CCFFFFFF" 
                                       FontSize="14" 
                                       HorizontalAlignment="Center"
                                       Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- ç©ºã®çŠ¶æ…‹è¡¨ç¤º -->
                    <Border Visibility="{Binding EmptyStateVisibility}" Background="White"
                            AllowDrop="True"
                            Drop="Window_Drop"
                            DragEnter="Window_DragEnter"
                            DragOver="Window_DragOver"
                            DragLeave="Window_DragLeave">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock Text="PDFã¾ãŸã¯ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ãã ã•ã„" 
                                       Foreground="#666666" 
                                       FontSize="16" 
                                       HorizontalAlignment="Center"/>
                            <TextBlock Text="ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°&amp;ãƒ‰ãƒ­ãƒƒãƒ—" 
                                       Foreground="#666666" 
                                       FontSize="18" 
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       Margin="0,12,0,0"/>
                            <Border Background="#E3F2FD" 
                                    BorderBrush="#1976D2" 
                                    BorderThickness="2" 
                                    CornerRadius="8" 
                                    Padding="16,8" 
                                    Margin="0,16,0,0">
                                <StackPanel>
                                    <TextBlock Text="å¯¾å¿œå½¢å¼:" 
                                               Foreground="#1976D2" 
                                               FontWeight="Bold" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="PDF, HEIC, JPG, PNG, JPEG" 
                                               Foreground="#1976D2" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,4,0,0"/>
                                    <TextBlock Text="ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¯è‡ªå‹•çš„ã«PDFã«å¤‰æ›ã•ã‚Œã¾ã™" 
                                               Foreground="#1976D2" 
                                               FontSize="12" 
                                               HorizontalAlignment="Center" 
                                               FontStyle="Italic"
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
        </Grid>

        <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ -->
        <StatusBar Grid.Row="3" Background="#F0F0F0">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            
            <StatusBarItem Grid.Column="0">
                <TextBlock Text="{Binding StatusMessage}"/>
            </StatusBarItem>
            
            <StatusBarItem Grid.Column="1">
                <ProgressBar Width="150" Height="16" 
                             Value="{Binding ProgressValue}" 
                             Visibility="{Binding ProgressVisibility}"/>
            </StatusBarItem>
            
            <StatusBarItem Grid.Column="2">
                <TextBlock Text="{Binding PageInfo}" Margin="8,0"/>
            </StatusBarItem>
            
            <StatusBarItem Grid.Column="3">
                <TextBlock Text="{Binding FileInfo}" Margin="8,0"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>